# gRINN Web Service Environment Configuration
# Copy this file to .env and customize for your deployment

# =============================================================================
# DATABASE CONFIGURATION
# =============================================================================
# For local development, use SQLite (no setup required)
DATABASE_URL=sqlite:////tmp/grinn_dev.db

# For production, use PostgreSQL
# DATABASE_URL=postgresql://grinn_user:your_password@localhost:5432/grinn_web

# =============================================================================
# LOCAL STORAGE CONFIGURATION
# =============================================================================
# Path to store job files (use NFS mount for multi-worker setups)
STORAGE_PATH=/data/grinn-jobs

# Job file retention period in hours (default: 72 = 3 days)
JOB_FILE_RETENTION_HOURS=72

# =============================================================================
# WORKER REGISTRATION
# =============================================================================
# Token for worker authentication (generate with: python -c "import secrets; print(secrets.token_urlsafe(32))")
# WORKER_REGISTRATION_TOKEN=your-secure-token-here

# Worker facility name
WORKER_FACILITY=main-facility

# =============================================================================
# REDIS CONFIGURATION
# =============================================================================
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_DB=0
CELERY_BROKER_URL=redis://localhost:6379/0
CELERY_RESULT_BACKEND=redis://localhost:6379/0

# =============================================================================
# APPLICATION CONFIGURATION
# =============================================================================
# Backend API server
BACKEND_HOST=0.0.0.0
BACKEND_PORT=5000

# Frontend dashboard
FRONTEND_HOST=0.0.0.0
FRONTEND_PORT=8051
FRONTEND_DEBUG=false

# =============================================================================
# GRINN DOCKER CONFIGURATION
# =============================================================================
GRINN_DOCKER_IMAGE=grinn:gromacs-2024.1
DOCKER_TIMEOUT=3600

# =============================================================================
# GRINN DASHBOARD DOCKER CONFIGURATION
# =============================================================================
# Docker image for interactive dashboard visualization
DASHBOARD_DOCKER_IMAGE=grinn-dashboard:latest

# Port range for dashboard instances (one port per active dashboard)
DASHBOARD_PORT_START=8100
DASHBOARD_PORT_END=8200

# Auto-stop inactive dashboards after timeout (seconds, 0 to disable)
DASHBOARD_TIMEOUT=3600

# Maximum concurrent dashboard instances
DASHBOARD_MAX_INSTANCES=10

# =============================================================================
# FILE UPLOAD LIMITS
# =============================================================================
MAX_TRAJECTORY_FILE_SIZE_MB=100
MAX_OTHER_FILE_SIZE_MB=10

# Optional global cap: fail preflight if exceeded
# Applies to trajectory frames (XTC/TRR) and ensemble PDB models
MAX_FRAMES=

JOB_RETENTION_DAYS=3
MAX_CONCURRENT_JOBS=10

# =============================================================================
# SECURITY
# =============================================================================
# Generate secure random strings for production
SECRET_KEY=dev-secret-key-change-in-production
JWT_SECRET_KEY=dev-jwt-secret-change-in-production

# Upload directory (ensure write permissions)
UPLOAD_FOLDER=/tmp/grinn-uploads

# =============================================================================
# LOGGING AND DEVELOPMENT
# =============================================================================
LOG_LEVEL=INFO
LOG_FORMAT=detailed
FLASK_ENV=development
DASH_ENV=development
DEBUG=true

# =============================================================================
# WORKER CONFIGURATION
# =============================================================================
CELERY_WORKER_CONCURRENCY=2
CELERY_WORKER_MAX_TASKS_PER_CHILD=1000